import{e as d,o as p,c as v,a as e,F as C,p as P,t as c,q as S,k as q,w as b,v as f,u as A,i as $,d as U,x as D,y as z,b as E,h as M}from"./index-DX7_LuGx.js";import{g as j,c as F,d as N,e as I}from"./productoService-BNVjtYum.js";const B={class:"container mx-auto p-4 bg-white rounded-lg shadow"},L={class:"flex justify-between items-center mb-4"},R={class:"overflow-x-auto"},T={class:"w-full border-collapse text-left"},G={class:"px-4 py-2"},H={class:"px-4 py-2"},J={class:"px-4 py-2"},K={class:"px-4 py-2"},O={class:"px-4 py-2 flex gap-2"},Q=["onClick"],W=["onClick"],X={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"},Y={class:"bg-white rounded-lg p-6 w-full max-w-md"},Z={class:"text-lg font-semibold mb-4"},ee=["value"],oe={class:"flex justify-end gap-2"},te={type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},se={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"},le={class:"bg-white rounded-lg p-6 w-full max-w-sm"},re={class:"flex justify-end gap-2"},ue={__name:"inventario",props:{products:{type:Array,required:!0}},emits:["update-product","add-product","delete-product"],setup(h,{emit:i}){const u=i,a=d(!1),r=d(null),g=d(!1),x=d(null),w=d([{id:1,nombre:"Refrescos"},{id:2,nombre:"Pan Dulce"}]),s=d({nombre:"",categorias:{},descripcion:"",codigo_barras:"",stock:0,precio_venta:0}),_=y=>{r.value=y,s.value={...y},a.value=!0},l=()=>{a.value=!1,r.value=null,s.value={nombre:"",categorias:{},descripcion:"",codigo_barras:"",stock:0,precio_venta:0}},n=()=>{r.value?u("update-product",{...r.value,...s.value}):u("add-product",{...s.value}),l()},m=y=>{x.value=y,g.value=!0},k=()=>{u("delete-product",x.value),g.value=!1,x.value=null};return(y,o)=>(p(),v("div",B,[e("div",L,[o[9]||(o[9]=e("h2",{class:"text-lg font-semibold"},"Gestión de Inventario",-1)),e("button",{onClick:o[0]||(o[0]=t=>a.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"}," Agregar Producto ")]),e("div",R,[e("table",T,[o[10]||(o[10]=e("thead",null,[e("tr",{class:"bg-gray-100 text-sm font-medium"},[e("th",{class:"px-4 py-2"},"Nombre"),e("th",{class:"px-4 py-2"},"Categoría"),e("th",{class:"px-4 py-2"},"Stock"),e("th",{class:"px-4 py-2"},"Precio"),e("th",{class:"px-4 py-2"},"Código de barras"),e("th",{class:"px-4 py-2"},"Acciones")])],-1)),e("tbody",null,[(p(!0),v(C,null,P(h.products,t=>(p(),v("tr",{key:t.producto_id,class:"hover:bg-gray-50 text-sm"},[e("td",G,c(t.nombre),1),e("td",H,c(t.categorias.nombre),1),e("td",{class:S(["px-4 py-2 font-medium",{"text-red-600":t.stock<5}])},c(t.stock),3),e("td",J,"$"+c(t.precio_venta.toFixed(2)),1),e("td",K,c(t.codigo_barras),1),e("td",O,[e("button",{onClick:V=>_(t),class:"bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600"}," Editar ",8,Q),e("button",{onClick:V=>m(t.producto_id),class:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600"}," Eliminar ",8,W)])]))),128))])])]),a.value||r.value?(p(),v("div",X,[e("div",Y,[e("h3",Z,c(r.value?"Editar":"Agregar")+" Producto ",1),e("form",{onSubmit:q(n,["prevent"]),class:"space-y-4"},[e("div",null,[o[11]||(o[11]=e("label",{class:"block text-sm font-medium mb-1"},"Nombre:",-1)),b(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>s.value.nombre=t),type:"text",required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[f,s.value.nombre]])]),e("div",null,[o[13]||(o[13]=e("label",{class:"block text-sm font-medium mb-1"},"Categoría:",-1)),b(e("select",{"onUpdate:modelValue":o[2]||(o[2]=t=>s.value.categorias.categoria_id=t),required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},[o[12]||(o[12]=e("option",{value:"",disabled:""},"Seleccione una categoría",-1)),(p(!0),v(C,null,P(w.value,t=>(p(),v("option",{key:t.id,value:t.id},c(t.nombre),9,ee))),128))],512),[[A,s.value.categorias.categoria_id]])]),e("div",null,[o[14]||(o[14]=e("label",{class:"block text-sm font-medium mb-1"},"Descripción:",-1)),b(e("textarea",{"onUpdate:modelValue":o[3]||(o[3]=t=>s.value.descripcion=t),required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[f,s.value.descripcion]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm font-medium mb-1"},"Código de barras:",-1)),b(e("input",{"onUpdate:modelValue":o[4]||(o[4]=t=>s.value.codigo_barras=t),required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[f,s.value.codigo_barras]])]),e("div",null,[o[16]||(o[16]=e("label",{class:"block text-sm font-medium mb-1"},"Stock:",-1)),b(e("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>s.value.stock=t),type:"number",required:"",min:"0",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[f,s.value.stock,void 0,{number:!0}]])]),e("div",null,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium mb-1"},"Precio:",-1)),b(e("input",{"onUpdate:modelValue":o[6]||(o[6]=t=>s.value.precio_venta=t),type:"number",required:"",min:"0",step:"0.01",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[f,s.value.precio_venta,void 0,{number:!0}]])]),e("div",null,[o[18]||(o[18]=e("label",{class:"block text-sm font-medium mb-1"},"URL de Imagen:",-1)),b(e("input",{"onUpdate:modelValue":o[7]||(o[7]=t=>s.value.image=t),type:"text",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[f,s.value.image]])]),e("div",oe,[e("button",te,c(r.value?"Actualizar":"Agregar"),1),e("button",{type:"button",onClick:l,class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"}," Cancelar ")])],32)])])):$("",!0),g.value?(p(),v("div",se,[e("div",le,[o[19]||(o[19]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirmar Eliminación",-1)),o[20]||(o[20]=e("p",{class:"text-sm mb-4"}," ¿Estás seguro de que deseas eliminar este producto? ",-1)),e("div",re,[e("button",{onClick:k,class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"}," Eliminar "),e("button",{onClick:o[8]||(o[8]=t=>g.value=!1),class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"}," Cancelar ")])])])):$("",!0)]))}},ae={class:"container mx-auto"},de=U({__name:"inventarioPage",setup(h){const i=d([]),u=d(!1),a=d(""),r=d("info");D(()=>{g()});const g=async()=>{const l=await j();console.log(l),l.success?i.value=l.data:(r.value="error",u.value=!0,a.value=`Error al cargar los productos: ${l.error}`)},x=async l=>{const n=await F(l);n.success?(r.value="success",u.value=!0,a.value="Se agrego el nuevo producto",i.value.push(n.data[0])):(r.value="error",u.value=!0,a.value=`Error al crear el producto: ${n.error}`)},w=async l=>{const n=await N(l);n.success||(r.value="error",u.value=!0,a.value=`Error al eliminar producto: ${n.error}`),r.value="success",u.value=!0,a.value="Se elimino el producto",i.value=i.value.filter(m=>m.producto_id!==l)},s=async l=>{const n=await I(l);n.success||(r.value="error",u.value=!0,a.value=`Error al actualizar: ${n.error}`);const m=i.value.findIndex(k=>k.producto_id===l.producto_id);m!==-1?i.value[m]={...i.value[m],...l}:(r.value="error",u.value=!0,a.value="Error no se encontro el producto"),r.value="success",u.value=!0,a.value=`Se actualizo el producto: ${l.nombre}`},_=()=>{u.value=!1};return(l,n)=>(p(),v(C,null,[e("div",ae,[b(E(M,{type:r.value,message:a.value,isVisible:u.value,dismissible:"",onClose:_},null,8,["type","message","isVisible"]),[[z,u.value]])]),E(ue,{products:i.value,onUpdateProduct:s,onAddProduct:x,onDeleteProduct:w},null,8,["products"])],64))}});export{de as default};
