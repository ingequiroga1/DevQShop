import{e as d,o as p,c as v,a as e,F as $,A as E,t as b,D as V,k as A,w as m,v as x,E as q,i as P,_ as U,d as D,n as L,y as z,b as h,h as M}from"./index-y-WAGp9W.js";import{g as j,c as F,d as I,e as N}from"./productoService-Drm_HGlK.js";const B={class:"container mx-auto p-4 bg-white rounded-lg shadow"},R={class:"flex justify-between items-center mb-4"},T={class:"overflow-x-auto"},G={class:"w-full border-collapse text-left"},H={class:"px-4 py-2"},J={class:"px-4 py-2"},K={class:"px-4 py-2"},O={class:"px-4 py-2"},Q={class:"px-4 py-2 flex gap-2"},W=["onClick"],X=["onClick"],Y={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"},Z={class:"bg-white rounded-lg p-6 w-full max-w-md"},ee={class:"text-lg font-semibold mb-4"},oe=["value"],se={class:"flex justify-end gap-2"},te={type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},le={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"},re={class:"bg-white rounded-lg p-6 w-full max-w-sm"},ae={class:"flex justify-end gap-2"},ne={__name:"inventario",props:{products:{type:Array,required:!0}},emits:["update-product","add-product","delete-product"],setup(w,{emit:u}){const r=u,n=d(!1),l=d(null),c=d(!1),y=d(null),k=d([{id:1,nombre:"Refrescos"},{id:2,nombre:"Pan Dulce"}]),t=d({nombre:"",categorias:{},descripcion:"",codigo_barras:"",stock:0,precio_venta:0}),C=f=>{l.value=f,t.value={...f},n.value=!0},_=()=>{n.value=!1,l.value=null,t.value={nombre:"",categorias:{},descripcion:"",codigo_barras:"",stock:0,precio_venta:0}},a=()=>{l.value?r("update-product",{...l.value,...t.value}):r("add-product",{...t.value}),_()},i=f=>{y.value=f,c.value=!0},g=()=>{r("delete-product",y.value),c.value=!1,y.value=null};return(f,o)=>(p(),v("div",B,[e("div",R,[o[9]||(o[9]=e("h2",{class:"text-lg font-semibold"},"Gestión de Inventario",-1)),e("button",{onClick:o[0]||(o[0]=s=>n.value=!0),class:"bg-primary-color text-white px-4 py-2 rounded hover:bg-blue-700"}," Agregar Producto ")]),e("div",T,[e("table",G,[o[10]||(o[10]=e("thead",null,[e("tr",{class:"bg-gray-100 text-sm font-medium"},[e("th",{class:"px-4 py-2"},"Nombre"),e("th",{class:"px-4 py-2"},"Categoría"),e("th",{class:"px-4 py-2"},"Stock"),e("th",{class:"px-4 py-2"},"Precio"),e("th",{class:"px-4 py-2"},"Código de barras"),e("th",{class:"px-4 py-2"},"Acciones")])],-1)),e("tbody",null,[(p(!0),v($,null,E(w.products,s=>(p(),v("tr",{key:s.producto_id,class:"hover:bg-gray-50 text-sm"},[e("td",H,b(s.nombre),1),e("td",J,b(s.categorias.nombre),1),e("td",{class:V(["px-4 py-2 font-medium",{"text-red-600":s.stock<5}])},b(s.stock),3),e("td",K,"$"+b(s.precio_venta.toFixed(2)),1),e("td",O,b(s.codigo_barras),1),e("td",Q,[e("button",{onClick:S=>C(s),class:"bg-primary-color text-white px-2 py-1 rounded hover:bg-blue-600"}," Editar ",8,W),e("button",{onClick:S=>i(s.producto_id),class:"bg-secondary-color text-white px-2 py-1 rounded hover:bg-red-600"}," Eliminar ",8,X)])]))),128))])])]),n.value||l.value?(p(),v("div",Y,[e("div",Z,[e("h3",ee,b(l.value?"Editar":"Agregar")+" Producto ",1),e("form",{onSubmit:A(a,["prevent"]),class:"space-y-4"},[e("div",null,[o[11]||(o[11]=e("label",{class:"block text-sm font-medium mb-1"},"Nombre:",-1)),m(e("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>t.value.nombre=s),type:"text",required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.nombre]])]),e("div",null,[o[13]||(o[13]=e("label",{class:"block text-sm font-medium mb-1"},"Categoría:",-1)),m(e("select",{"onUpdate:modelValue":o[2]||(o[2]=s=>t.value.categorias.categoria_id=s),required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},[o[12]||(o[12]=e("option",{value:"",disabled:""},"Seleccione una categoría",-1)),(p(!0),v($,null,E(k.value,s=>(p(),v("option",{key:s.id,value:s.id},b(s.nombre),9,oe))),128))],512),[[q,t.value.categorias.categoria_id]])]),e("div",null,[o[14]||(o[14]=e("label",{class:"block text-sm font-medium mb-1"},"Descripción:",-1)),m(e("textarea",{"onUpdate:modelValue":o[3]||(o[3]=s=>t.value.descripcion=s),required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.descripcion]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm font-medium mb-1"},"Código de barras:",-1)),m(e("input",{"onUpdate:modelValue":o[4]||(o[4]=s=>t.value.codigo_barras=s),required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.codigo_barras]])]),e("div",null,[o[16]||(o[16]=e("label",{class:"block text-sm font-medium mb-1"},"Stock:",-1)),m(e("input",{"onUpdate:modelValue":o[5]||(o[5]=s=>t.value.stock=s),type:"number",required:"",min:"0",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.stock,void 0,{number:!0}]])]),e("div",null,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium mb-1"},"Precio:",-1)),m(e("input",{"onUpdate:modelValue":o[6]||(o[6]=s=>t.value.precio_venta=s),type:"number",required:"",min:"0",step:"0.01",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.precio_venta,void 0,{number:!0}]])]),e("div",null,[o[18]||(o[18]=e("label",{class:"block text-sm font-medium mb-1"},"URL de Imagen:",-1)),m(e("input",{"onUpdate:modelValue":o[7]||(o[7]=s=>t.value.image=s),type:"text",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.image]])]),e("div",se,[e("button",te,b(l.value?"Actualizar":"Agregar"),1),e("button",{type:"button",onClick:_,class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"}," Cancelar ")])],32)])])):P("",!0),c.value?(p(),v("div",le,[e("div",re,[o[19]||(o[19]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirmar Eliminación",-1)),o[20]||(o[20]=e("p",{class:"text-sm mb-4"}," ¿Estás seguro de que deseas eliminar este producto? ",-1)),e("div",ae,[e("button",{onClick:g,class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"}," Eliminar "),e("button",{onClick:o[8]||(o[8]=s=>c.value=!1),class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"}," Cancelar ")])])])):P("",!0)]))}},ue={props:{isLoading:{type:Boolean,required:!0}}},ie={key:0,class:"spinner"};function de(w,u,r,n,l,c){return r.isLoading?(p(),v("div",ie,u[0]||(u[0]=[e("div",{class:"double-bounce1"},null,-1),e("div",{class:"double-bounce2"},null,-1)]))):P("",!0)}const ce=U(ue,[["render",de],["__scopeId","data-v-bd987d5d"]]),pe={class:"container mx-auto"},me=D({__name:"inventarioPage",setup(w){const u=d([]),r=d(!1),n=d(""),l=d("info"),c=d(!1);L(()=>{y()});const y=async()=>{c.value=!0;const a=await j();c.value=!1,a.success?u.value=a.data:(l.value="error",r.value=!0,n.value=`Error al cargar los productos: ${a.error}`)},k=async a=>{const i=await F(a);i.success?(l.value="success",r.value=!0,n.value="Se agrego el nuevo producto",u.value.push(i.data[0])):(l.value="error",r.value=!0,n.value=`Error al crear el producto: ${i.error}`)},t=async a=>{const i=await I(a);i.success||(l.value="error",r.value=!0,n.value=`Error al eliminar producto: ${i.error}`),l.value="success",r.value=!0,n.value="Se elimino el producto",u.value=u.value.filter(g=>g.producto_id!==a)},C=async a=>{const i=await N(a);i.success||(l.value="error",r.value=!0,n.value=`Error al actualizar: ${i.error}`);const g=u.value.findIndex(f=>f.producto_id===a.producto_id);g!==-1?u.value[g]={...u.value[g],...a}:(l.value="error",r.value=!0,n.value="Error no se encontro el producto"),l.value="success",r.value=!0,n.value=`Se actualizo el producto: ${a.nombre}`},_=()=>{r.value=!1};return(a,i)=>(p(),v($,null,[e("div",pe,[m(h(M,{type:l.value,message:n.value,isVisible:r.value,dismissible:"",onClose:_},null,8,["type","message","isVisible"]),[[z,r.value]])]),h(ce,{isLoading:c.value},null,8,["isLoading"]),h(ne,{products:u.value,onUpdateProduct:C,onAddProduct:k,onDeleteProduct:t},null,8,["products"])],64))}});export{me as default};
