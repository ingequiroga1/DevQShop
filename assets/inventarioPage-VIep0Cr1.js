import{e as d,o as p,c as b,a as e,F as E,t as P,u as m,y as L,k as $,w as v,v as x,z as I,i as S,_ as R,d as U,A as T,p as M,b as C,h as V}from"./index-DjUQmj9o.js";import{g as D,c as N,d as q,e as B}from"./productoService-CrL9bfmF.js";const O={class:"container mx-auto p-4 bg-white rounded-lg shadow"},F={class:"flex justify-between items-center mb-4"},z={class:"overflow-x-auto"},j={class:"w-full border-collapse text-left"},G={class:"px-4 py-2"},H={class:"px-4 py-2"},J={class:"px-4 py-2"},K={class:"px-4 py-2"},Q={class:"px-4 py-2 flex gap-2"},W=["onClick"],X=["onClick"],Y={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"},Z={class:"bg-white rounded-lg p-6 w-full max-w-md"},ee={class:"text-lg font-semibold mb-4"},oe=["value"],se={class:"flex justify-end gap-2"},te={type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},le={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"},re={class:"bg-white rounded-lg p-6 w-full max-w-sm"},ne={class:"flex justify-end gap-2"},ae={__name:"inventario",props:{products:{type:Array,required:!0}},emits:["update-product","add-product","delete-product"],setup(A,{emit:u}){const r=u,a=d(!1),l=d(null),c=d(!1),y=d(null),w=d([{id:1,nombre:"Refrescos"},{id:2,nombre:"Pan Dulce"},{id:3,nombre:"FARMACIA"},{id:4,nombre:"PANES"},{id:5,nombre:"GALLETAS"},{id:6,nombre:"BOTANAS"},{id:7,nombre:"PAPELERIA"},{id:8,nombre:"FERRETERIA"},{id:9,nombre:"ACCS. CELULARES"},{id:10,nombre:"ABARROTE"},{id:11,nombre:"DULCERIA"},{id:12,nombre:"AGUA"},{id:13,nombre:"ALIMENTO PARA MASCOTAS"},{id:14,nombre:"LACTEOS"},{id:15,nombre:"EMBUTIDOS"},{id:16,nombre:"BEBIDAS"},{id:17,nombre:"FORMULAS LACTEAS"},{id:18,nombre:"ALIMENTOS"},{id:19,nombre:"SIN CATEGORIA"}]),t=d({nombre:"",categorias:{},descripcion:"",codigo_barras:"",stock:0,precio_venta:0}),k=f=>{l.value=f,t.value={...f},a.value=!0},_=()=>{a.value=!1,l.value=null,t.value={nombre:"",categorias:{},descripcion:"",codigo_barras:"",stock:0,precio_venta:0}},n=()=>{l.value?r("update-product",{...l.value,...t.value}):r("add-product",{...t.value}),_()},i=f=>{y.value=f,c.value=!0},g=()=>{r("delete-product",y.value),c.value=!1,y.value=null};return(f,o)=>(p(),b("div",O,[e("div",F,[o[9]||(o[9]=e("h2",{class:"text-lg font-semibold"},"Gestión de Inventario",-1)),e("button",{onClick:o[0]||(o[0]=s=>a.value=!0),class:"bg-primary-color text-white px-4 py-2 rounded hover:bg-blue-700"}," Agregar Producto ")]),e("div",z,[e("table",j,[o[10]||(o[10]=e("thead",null,[e("tr",{class:"bg-gray-100 text-sm font-medium"},[e("th",{class:"px-4 py-2"},"Nombre"),e("th",{class:"px-4 py-2"},"Categoría"),e("th",{class:"px-4 py-2"},"Stock"),e("th",{class:"px-4 py-2"},"Precio"),e("th",{class:"px-4 py-2"},"Código de barras"),e("th",{class:"px-4 py-2"},"Acciones")])],-1)),e("tbody",null,[(p(!0),b(E,null,P(A.products,s=>(p(),b("tr",{key:s.producto_id,class:"hover:bg-gray-50 text-sm"},[e("td",G,m(s.nombre),1),e("td",H,m(s.categorias.nombre),1),e("td",{class:L(["px-4 py-2 font-medium",{"text-red-600":s.stock<5}])},m(s.stock),3),e("td",J,"$"+m(s.precio_venta.toFixed(2)),1),e("td",K,m(s.codigo_barras),1),e("td",Q,[e("button",{onClick:h=>k(s),class:"bg-primary-color text-white px-2 py-1 rounded hover:bg-blue-600"}," Editar ",8,W),e("button",{onClick:h=>i(s.producto_id),class:"bg-secondary-color text-white px-2 py-1 rounded hover:bg-red-600"}," Eliminar ",8,X)])]))),128))])])]),a.value||l.value?(p(),b("div",Y,[e("div",Z,[e("h3",ee,m(l.value?"Editar":"Agregar")+" Producto ",1),e("form",{onSubmit:$(n,["prevent"]),class:"space-y-4"},[e("div",null,[o[11]||(o[11]=e("label",{class:"block text-sm font-medium mb-1"},"Nombre:",-1)),v(e("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>t.value.nombre=s),type:"text",required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.nombre]])]),e("div",null,[o[13]||(o[13]=e("label",{class:"block text-sm font-medium mb-1"},"Categoría:",-1)),v(e("select",{"onUpdate:modelValue":o[2]||(o[2]=s=>t.value.categorias.categoria_id=s),required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},[o[12]||(o[12]=e("option",{value:"",disabled:""},"Seleccione una categoría",-1)),(p(!0),b(E,null,P(w.value,s=>(p(),b("option",{key:s.id,value:s.id},m(s.nombre),9,oe))),128))],512),[[I,t.value.categorias.categoria_id]])]),e("div",null,[o[14]||(o[14]=e("label",{class:"block text-sm font-medium mb-1"},"Descripción:",-1)),v(e("textarea",{"onUpdate:modelValue":o[3]||(o[3]=s=>t.value.descripcion=s),required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.descripcion]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm font-medium mb-1"},"Código de barras:",-1)),v(e("input",{"onUpdate:modelValue":o[4]||(o[4]=s=>t.value.codigo_barras=s),required:"",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.codigo_barras]])]),e("div",null,[o[16]||(o[16]=e("label",{class:"block text-sm font-medium mb-1"},"Stock:",-1)),v(e("input",{"onUpdate:modelValue":o[5]||(o[5]=s=>t.value.stock=s),type:"number",required:"",min:"0",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.stock,void 0,{number:!0}]])]),e("div",null,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium mb-1"},"Precio:",-1)),v(e("input",{"onUpdate:modelValue":o[6]||(o[6]=s=>t.value.precio_venta=s),type:"number",required:"",min:"0",step:"0.01",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.precio_venta,void 0,{number:!0}]])]),e("div",null,[o[18]||(o[18]=e("label",{class:"block text-sm font-medium mb-1"},"URL de Imagen:",-1)),v(e("input",{"onUpdate:modelValue":o[7]||(o[7]=s=>t.value.image=s),type:"text",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300"},null,512),[[x,t.value.image]])]),e("div",se,[e("button",te,m(l.value?"Actualizar":"Agregar"),1),e("button",{type:"button",onClick:_,class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"}," Cancelar ")])],32)])])):S("",!0),c.value?(p(),b("div",le,[e("div",re,[o[19]||(o[19]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirmar Eliminación",-1)),o[20]||(o[20]=e("p",{class:"text-sm mb-4"}," ¿Estás seguro de que deseas eliminar este producto? ",-1)),e("div",ne,[e("button",{onClick:g,class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"}," Eliminar "),e("button",{onClick:o[8]||(o[8]=s=>c.value=!1),class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"}," Cancelar ")])])])):S("",!0)]))}},ue={props:{isLoading:{type:Boolean,required:!0}}},ie={key:0,class:"spinner"};function de(A,u,r,a,l,c){return r.isLoading?(p(),b("div",ie,u[0]||(u[0]=[e("div",{class:"double-bounce1"},null,-1),e("div",{class:"double-bounce2"},null,-1)]))):S("",!0)}const ce=R(ue,[["render",de],["__scopeId","data-v-bd987d5d"]]),pe={class:"container mx-auto"},ve=U({__name:"inventarioPage",setup(A){const u=d([]),r=d(!1),a=d(""),l=d("info"),c=d(!1);T(()=>{y()});const y=async()=>{c.value=!0;const n=await D();c.value=!1,n.success?u.value=n.data:(l.value="error",r.value=!0,a.value=`Error al cargar los productos: ${n.error}`)},w=async n=>{const i=await N(n);i.success?(l.value="success",r.value=!0,a.value="Se agrego el nuevo producto",u.value.push(i.data[0])):(l.value="error",r.value=!0,a.value=`Error al crear el producto: ${i.error}`)},t=async n=>{const i=await q(n);i.success||(l.value="error",r.value=!0,a.value=`Error al eliminar producto: ${i.error}`),l.value="success",r.value=!0,a.value="Se elimino el producto",u.value=u.value.filter(g=>g.producto_id!==n)},k=async n=>{const i=await B(n);i.success||(l.value="error",r.value=!0,a.value=`Error al actualizar: ${i.error}`);const g=u.value.findIndex(f=>f.producto_id===n.producto_id);g!==-1?u.value[g]={...u.value[g],...n}:(l.value="error",r.value=!0,a.value="Error no se encontro el producto"),l.value="success",r.value=!0,a.value=`Se actualizo el producto: ${n.nombre}`},_=()=>{r.value=!1};return(n,i)=>(p(),b(E,null,[e("div",pe,[v(C(V,{type:l.value,message:a.value,isVisible:r.value,dismissible:"",onClose:_},null,8,["type","message","isVisible"]),[[M,r.value]])]),C(ce,{isLoading:c.value},null,8,["isLoading"]),C(ae,{products:u.value,onUpdateProduct:k,onAddProduct:w,onDeleteProduct:t},null,8,["products"])],64))}});export{ve as default};
